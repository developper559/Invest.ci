<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InvestCI Pro - Plateforme d'Investissement BRVM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        .stock-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #e2e8f0;
        }
        .stock-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border-color: #3b82f6;
        }
        .price-up { color: #059669; }
        .price-down { color: #dc2626; }
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
            transform: translateY(-1px);
        }
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .btn-success:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        .btn-warning:hover {
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
        }
        .stats-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-left: 4px solid;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <!-- Header -->
    <header class="gradient-bg text-white shadow-2xl">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-chart-line text-blue-600 text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">InvestCI Pro</h1>
                        <p class="text-sm opacity-80">Plateforme d'Investissement BRVM</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="text-right bg-white bg-opacity-10 rounded-lg px-4 py-2">
                        <p class="text-sm opacity-90">Solde disponible</p>
                        <p class="text-2xl font-bold" id="headerBalance">0 F CFA</p>
                    </div>
                    <button onclick="openRechargeModal()" 
                            class="btn-success text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2 shadow-lg">
                        <i class="fas fa-plus"></i>
                        <span>Recharger</span>
                    </button>
                    <button onclick="openWithdrawModal()" 
                            class="btn-warning text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2 shadow-lg">
                        <i class="fas fa-minus"></i>
                        <span>Retirer</span>
                    </button>
                    <button onclick="logout()" 
                            class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-3 rounded-lg transition flex items-center space-x-2">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Déconnexion</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Portfolio Overview -->
        <div class="bg-white rounded-2xl card-shadow p-8 mb-8">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800">Tableau de Bord</h2>
                <div class="flex items-center space-x-2 text-green-600">
                    <i class="fas fa-circle text-xs animate-pulse"></i>
                    <span class="text-sm font-medium">Marché ouvert</span>
                </div>
            </div>
            
            <div class="grid md:grid-cols-4 gap-6">
                <div class="stats-card border-l-blue-500 p-6 rounded-xl">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-semibold text-gray-600 mb-2">Solde Total</h3>
                            <p class="text-3xl font-bold text-blue-600" id="totalBalance">0 F</p>
                        </div>
                        <i class="fas fa-wallet text-blue-500 text-2xl"></i>
                    </div>
                </div>
                
                <div class="stats-card border-l-green-500 p-6 rounded-xl">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-semibold text-gray-600 mb-2">Actions Détenues</h3>
                            <p class="text-3xl font-bold text-green-600" id="stocksValue">0 F</p>
                        </div>
                        <i class="fas fa-chart-pie text-green-500 text-2xl"></i>
                    </div>
                </div>
                
                <div class="stats-card border-l-purple-500 p-6 rounded-xl">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-semibold text-gray-600 mb-2">Gains/Pertes</h3>
                            <p class="text-3xl font-bold text-purple-600" id="totalGains">0 F</p>
                        </div>
                        <i class="fas fa-trending-up text-purple-500 text-2xl"></i>
                    </div>
                </div>
                
                <div class="stats-card border-l-orange-500 p-6 rounded-xl">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-sm font-semibold text-gray-600 mb-2">Rendement</h3>
                            <p class="text-3xl font-bold text-orange-600" id="totalReturn">0%</p>
                        </div>
                        <i class="fas fa-percentage text-orange-500 text-2xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stock Market -->
        <div class="bg-white rounded-2xl card-shadow p-8 mb-8">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl font-bold text-gray-800">Bourse Régionale des Valeurs Mobilières</h2>
                    <p class="text-gray-600 mt-2">Investissement minimum: 25 000 F CFA par action</p>
                </div>
                <div class="bg-blue-50 px-4 py-2 rounded-lg">
                    <span class="text-blue-800 font-semibold">BRVM - Abidjan</span>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="stocksContainer">
                <!-- Stocks will be populated by JavaScript -->
            </div>
        </div>

        <!-- My Portfolio -->
        <div class="bg-white rounded-2xl card-shadow p-8">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800">Mon Portefeuille</h2>
                <button onclick="refreshPortfolio()" class="text-blue-600 hover:text-blue-800 flex items-center space-x-2">
                    <i class="fas fa-sync-alt"></i>
                    <span>Actualiser</span>
                </button>
            </div>
            <div id="myStocksContainer">
                <div class="text-center py-12">
                    <i class="fas fa-chart-line text-gray-300 text-6xl mb-4"></i>
                    <p class="text-gray-500 text-lg">Aucun investissement pour le moment</p>
                    <p class="text-gray-400">Commencez à investir avec seulement 25 000 F CFA</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Recharge Modal -->
    <div id="rechargeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-plus text-green-600 text-2xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800">Recharger mon compte</h3>
                <p class="text-gray-600 mt-2">Ajoutez des fonds à votre portefeuille</p>
            </div>
            
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-3">Montant (F CFA)</label>
                <input type="number" id="rechargeAmount" min="25000" placeholder="25000" 
                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg">
                <p class="text-sm text-gray-500 mt-2">Montant minimum: 25 000 F CFA</p>
            </div>
            
            <div class="mb-8">
                <label class="block text-gray-700 font-semibold mb-3">Méthode de paiement</label>
                <div class="w-full px-4 py-4 border-2 border-blue-200 rounded-xl bg-blue-50 text-blue-800 font-semibold flex items-center space-x-3">
                    <i class="fas fa-mobile-alt text-blue-600"></i>
                    <span>Wave uniquement</span>
                </div>
            </div>
            
            <div class="flex space-x-4">
                <button onclick="closeRechargeModal()" 
                        class="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-xl hover:bg-gray-300 transition font-semibold">
                    Annuler
                </button>
                <button onclick="processRecharge()" 
                        class="flex-1 btn-primary text-white py-3 px-6 rounded-xl font-semibold">
                    Continuer
                </button>
            </div>
        </div>
    </div>

    <!-- Withdraw Modal -->
    <div id="withdrawModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-minus text-orange-600 text-2xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800">Retirer des fonds</h3>
                <p class="text-gray-600 mt-2">Retirez de l'argent de votre compte</p>
            </div>
            
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-3">Montant à retirer (F CFA)</label>
                <input type="number" id="withdrawAmount" min="25000" placeholder="25000" 
                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-lg">
                <p class="text-sm text-gray-500 mt-2">Montant minimum: 25 000 F CFA</p>
            </div>
            
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-3">Numéro Wave</label>
                <input type="tel" id="withdrawPhone" placeholder="07 XX XX XX XX" 
                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-lg">
            </div>
            
            <div class="flex space-x-4">
                <button onclick="closeWithdrawModal()" 
                        class="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-xl hover:bg-gray-300 transition font-semibold">
                    Annuler
                </button>
                <button onclick="processWithdraw()" 
                        class="flex-1 btn-warning text-white py-3 px-6 rounded-xl font-semibold">
                    Retirer
                </button>
            </div>
        </div>
    </div>

    <!-- Payment Instructions Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Instructions de paiement</h3>
            <div id="paymentInstructions" class="mb-6">
                <!-- Instructions will be populated by JavaScript -->
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-3">Capture d'écran de la transaction</label>
                <input type="file" id="screenshot" accept="image/*" 
                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                <p class="text-sm text-gray-500 mt-2">Téléchargez la preuve de votre transaction</p>
            </div>
            <div class="flex space-x-4">
                <button onclick="closePaymentModal()" 
                        class="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-xl hover:bg-gray-300 transition font-semibold">
                    Retour
                </button>
                <button onclick="confirmPayment()" 
                        class="flex-1 btn-success text-white py-3 px-6 rounded-xl font-semibold">
                    Confirmer
                </button>
            </div>
        </div>
    </div>

    <!-- Buy Stock Modal -->
    <div id="buyStockModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Investir dans cette action</h3>
            <div id="stockInfo" class="mb-6">
                <!-- Stock info will be populated by JavaScript -->
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-3">Montant à investir (F CFA)</label>
                <input type="number" id="buyAmount" min="25000" placeholder="25000" 
                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg">
                <p class="text-sm text-gray-500 mt-2">Minimum: 25 000 F CFA</p>
            </div>
            <div class="flex space-x-4">
                <button onclick="closeBuyModal()" 
                        class="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-xl hover:bg-gray-300 transition font-semibold">
                    Annuler
                </button>
                <button onclick="confirmBuy()" 
                        class="flex-1 btn-primary text-white py-3 px-6 rounded-xl font-semibold">
                    Investir
                </button>
            </div>
        </div>
    </div>

    <script>
        let userBalance = 0;
        let userStocks = {};
        let currentStock = null;
        let pendingRecharge = 0;

        const stocks = [
            { id: 'SIFCA', name: 'SIFCA Group', price: 25000, change: 1.8, sector: 'Agro-industrie', volume: '2.5M' },
            { id: 'SOGB', name: 'Société Générale CI', price: 125000, change: -0.5, sector: 'Banque', volume: '1.8M' },
            { id: 'PALM', name: 'PALMCI', price: 95000, change: 2.3, sector: 'Agro-industrie', volume: '3.2M' },
            { id: 'ECOBANK', name: 'Ecobank CI', price: 110000, change: 0.8, sector: 'Banque', volume: '1.5M' },
            { id: 'SOLIBRA', name: 'SOLIBRA', price: 75000, change: -1.2, sector: 'Brasserie', volume: '900K' },
            { id: 'ORANGE', name: 'Orange CI', price: 165000, change: 2.1, sector: 'Télécoms', volume: '2.1M' }
        ];

        function updateDisplay() {
            const stocksValue = Object.values(userStocks).reduce((total, stock) => total + stock.value, 0);
            const totalGains = Object.values(userStocks).reduce((total, stock) => total + stock.gains, 0);
            const totalReturn = stocksValue > 0 ? ((totalGains / stocksValue) * 100).toFixed(1) : 0;

            document.getElementById('headerBalance').textContent = userBalance.toLocaleString() + ' F CFA';
            document.getElementById('totalBalance').textContent = (userBalance + stocksValue).toLocaleString() + ' F';
            document.getElementById('stocksValue').textContent = stocksValue.toLocaleString() + ' F';
            document.getElementById('totalGains').textContent = totalGains.toLocaleString() + ' F';
            document.getElementById('totalReturn').textContent = totalReturn + '%';
        }

        function renderStocks() {
            const container = document.getElementById('stocksContainer');
            container.innerHTML = stocks.map(stock => `
                <div class="stock-card bg-white rounded-xl p-6 cursor-pointer" onclick="openBuyModal('${stock.id}')">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="font-bold text-xl text-gray-800">${stock.id}</h3>
                            <p class="text-sm text-gray-600 mb-1">${stock.name}</p>
                            <span class="inline-block bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded-full">${stock.sector}</span>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-xl text-gray-800">${stock.price.toLocaleString()} F</p>
                            <p class="text-sm ${stock.change >= 0 ? 'price-up' : 'price-down'} font-semibold">
                                ${stock.change >= 0 ? '+' : ''}${stock.change}%
                            </p>
                        </div>
                    </div>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-xs text-gray-500">Volume: ${stock.volume}</span>
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-circle text-xs ${stock.change >= 0 ? 'text-green-500' : 'text-red-500'}"></i>
                            <span class="text-xs text-gray-500">Live</span>
                        </div>
                    </div>
                    <button class="w-full btn-primary text-white py-3 rounded-xl font-semibold flex items-center justify-center space-x-2">
                        <i class="fas fa-chart-line"></i>
                        <span>Investir</span>
                    </button>
                </div>
            `).join('');
        }

        function renderMyStocks() {
            const container = document.getElementById('myStocksContainer');
            const myStocksList = Object.values(userStocks);
            
            if (myStocksList.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-chart-line text-gray-300 text-6xl mb-4"></i>
                        <p class="text-gray-500 text-lg">Aucun investissement pour le moment</p>
                        <p class="text-gray-400">Commencez à investir avec seulement 25 000 F CFA</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = myStocksList.map(stock => `
                <div class="border border-gray-200 rounded-xl p-6 mb-4 hover:shadow-lg transition">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-building text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg text-gray-800">${stock.symbol}</h4>
                                <p class="text-sm text-gray-600">${stock.shares} actions</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-lg text-gray-800">${stock.value.toLocaleString()} F</p>
                            <p class="text-sm ${stock.gains >= 0 ? 'price-up' : 'price-down'} font-semibold">
                                ${stock.gains >= 0 ? '+' : ''}${stock.gains.toLocaleString()} F
                            </p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openRechargeModal() {
            document.getElementById('rechargeModal').classList.remove('hidden');
        }

        function closeRechargeModal() {
            document.getElementById('rechargeModal').classList.add('hidden');
        }

        function openWithdrawModal() {
            document.getElementById('withdrawModal').classList.remove('hidden');
        }

        function closeWithdrawModal() {
            document.getElementById('withdrawModal').classList.add('hidden');
        }

        function processRecharge() {
            const amount = parseInt(document.getElementById('rechargeAmount').value);

            if (!amount || amount < 25000) {
                alert('Le montant minimum de recharge est de 25 000 F CFA');
                return;
            }

            pendingRecharge = amount;
            
            const instructions = `
                <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
                    <div class="flex items-center space-x-3 mb-4">
                        <i class="fas fa-mobile-alt text-blue-600 text-2xl"></i>
                        <h4 class="font-bold text-blue-800 text-lg">Paiement Wave</h4>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="font-semibold text-gray-700">Numéro:</span>
                            <span class="font-bold text-blue-800">07-05-23-00-33</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-semibold text-gray-700">Montant:</span>
                            <span class="font-bold text-green-600">${amount.toLocaleString()} F CFA</span>
                        </div>
                    </div>
                    <div class="mt-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded">
                        <p class="text-sm text-yellow-800">
                            <strong>Étapes à suivre:</strong><br>
                            1. Ouvrez votre application Wave<br>
                            2. Envoyez ${amount.toLocaleString()} F CFA au 07-05-23-00-33<br>
                            3. Prenez une capture d'écran de la confirmation<br>
                            4. Téléchargez la capture ci-dessous pour validation
                        </p>
                    </div>
                </div>
            `;

            document.getElementById('paymentInstructions').innerHTML = instructions;
            closeRechargeModal();
            document.getElementById('paymentModal').classList.remove('hidden');
        }

        function processWithdraw() {
            const amount = parseInt(document.getElementById('withdrawAmount').value);
            const phone = document.getElementById('withdrawPhone').value;

            if (!amount || amount < 25000) {
                alert('Le montant minimum de retrait est de 25 000 F CFA');
                return;
            }

            if (!phone) {
                alert('Veuillez saisir votre numéro Wave');
                return;
            }

            if (amount > userBalance) {
                alert('Solde insuffisant pour effectuer ce retrait');
                return;
            }

            if (confirm(`Confirmer le retrait de ${amount.toLocaleString()} F CFA vers ${phone}?`)) {
                userBalance -= amount;
                updateDisplay();
                closeWithdrawModal();
                alert(`Demande de retrait de ${amount.toLocaleString()} F CFA envoyée. Vous recevrez les fonds sous 24h.`);
            }
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.add('hidden');
        }

        function confirmPayment() {
            const screenshot = document.getElementById('screenshot').files[0];
            if (!screenshot) {
                alert('Veuillez télécharger une capture d\'écran de votre transaction');
                return;
            }

            alert('Transaction en cours de vérification. Vous recevrez une confirmation sous 24h.');
            closePaymentModal();
            
            // Simulate payment confirmation after 3 seconds
            setTimeout(() => {
                userBalance += pendingRecharge;
                updateDisplay();
                alert(`✅ Recharge confirmée! ${pendingRecharge.toLocaleString()} F CFA ajoutés à votre compte.`);
                pendingRecharge = 0;
            }, 3000);
        }

        function openBuyModal(stockId) {
            const stock = stocks.find(s => s.id === stockId);
            currentStock = stock;
            
            document.getElementById('stockInfo').innerHTML = `
                <div class="bg-gradient-to-r from-gray-50 to-gray-100 p-6 rounded-xl border">
                    <div class="flex items-center space-x-4 mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-building text-blue-600"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-xl text-gray-800">${stock.name}</h4>
                            <p class="text-gray-600">${stock.id} - ${stock.sector}</p>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-3xl font-bold text-blue-600">${stock.price.toLocaleString()} F</span>
                        <span class="text-lg ${stock.change >= 0 ? 'price-up' : 'price-down'} font-semibold">
                            ${stock.change >= 0 ? '+' : ''}${stock.change}%
                        </span>
                    </div>
                </div>
            `;
            
            document.getElementById('buyStockModal').classList.remove('hidden');
        }

        function closeBuyModal() {
            document.getElementById('buyStockModal').classList.add('hidden');
            currentStock = null;
        }

        function confirmBuy() {
            const amount = parseInt(document.getElementById('buyAmount').value);
            
            if (!amount || amount < 25000) {
                alert('Le montant minimum d\'investissement est de 25 000 F CFA');
                return;
            }

            if (amount > userBalance) {
                alert('Solde insuffisant. Veuillez recharger votre compte.');
                return;
            }

            const shares = Math.floor(amount / currentStock.price);
            const actualAmount = shares * currentStock.price;

            if (userStocks[currentStock.id]) {
                userStocks[currentStock.id].shares += shares;
                userStocks[currentStock.id].value += actualAmount;
            } else {
                userStocks[currentStock.id] = {
                    symbol: currentStock.id,
                    name: currentStock.name,
                    shares: shares,
                    value: actualAmount,
                    gains: 0
                };
            }

            userBalance -= actualAmount;
            updateDisplay();
            renderMyStocks();

            alert(`✅ Investissement confirmé! ${shares} actions ${currentStock.id} pour ${actualAmount.toLocaleString()} F CFA`);
            closeBuyModal();
        }

        function refreshPortfolio() {
            renderMyStocks();
            updateDisplay();
        }

        function logout() {
            if (confirm('Êtes-vous sûr de vouloir vous déconnecter?')) {
                alert('Déconnexion réussie. À bientôt sur InvestCI Pro!');
            }
        }

        // Initialize the application
        renderStocks();
        updateDisplay();
        renderMyStocks();

        // Simulate stock price updates every 15 seconds
        setInterval(() => {
            stocks.forEach(stock => {
                const change = (Math.random() - 0.5) * 3; // Random change between -1.5% and +1.5%
                stock.change = parseFloat(change.toFixed(1));
                stock.price = Math.max(25000, Math.floor(stock.price * (1 + change/100)));
            });
            renderStocks();
            
            // Update user stocks gains
            Object.keys(userStocks).forEach(stockId => {
                const stock = stocks.find(s => s.id === stockId);
                if (stock) {
                    const currentValue = userStocks[stockId].shares * stock.price;
                    userStocks[stockId].gains = currentValue - userStocks[stockId].value;
                }
            });
            updateDisplay();
            renderMyStocks();
        }, 15000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9812bfe3c3cfb79f',t:'MTc1ODIxODQ5Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
